<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">
<head>
    <title>Search Outlets</title>
    <style type="text/css">
        #Text1 {
            width: 298px;
        }
        #Button1 {
            width: 76px;
        }
    </style>


    <script src="http://ajax.aspnetcdn.com/ajax/jQuery/jquery-2.0.3.min.js"></script>
    <script type="text/javascript">

        // immediately request that the indexing be initialized
        $.ajax({
            type: 'GET',
            url: '/initializeindexing',
        });


        $(function() {
            $('#Button1').click(getContacts);
        });

        function displayContacts(response) {
            var contacts = response;
            $('#output').empty();
            $.each(contacts, function (index, contact) {
                $('#output').append(
                    '<p>' +
                    '<b>Name:</b> ' + contact.Name + '<br/>' +
                    '<b>Title:</b> ' + contact.Title + '<br/>' +
                    '<b>Outlet:</b> ' + contact.Outlet + '<br/>' +
                    '<b>Profile:</b> ' + contact.Profile + '<br/>' +
                    '</p>'
                );
            });
        }

        function getContacts() {
            // the value of the text field
            var searchTerm = $('#Text1').val();
            
            // default case: no search term returns all contacts
            var url = '/contact';
            var data = { };
            
            // if the text area is not empty, perform a search
            if (searchTerm) {
                url = '/search';
                data = { query: searchTerm };
            }
            
            $.ajax({
                type: 'GET',
                url: url,
                data: data,
                contentType: 'application/json; charset=utf-8',
                dataType: 'json',
                success: function (response) {
                    displayContacts(response);
                },
                failure: function (msg) {
                    $('#output').text(msg);
                }
            });
        }
    </script>

</head>
<body>
    <form id="form1">

        <div id="title" style="font-family: Arial, Helvetica, sans-serif; font-size: x-large">

            Search Outlets

        </div>

        <div id="search">
            <input id="Text1" type="text" />
            <input id="Button1" type="button" value="Search" /><br />
        </div>

        <div id="output" style="font-family: Arial, Helvetica, sans-serif;">
        </div>
    </form>
</body>
</html>
